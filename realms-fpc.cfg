# Free Pascal configuration file for Realms project

# NOTE ON MACOS UNIVERSAL BINARY:
# To create a universal binary (Intel x86_64 + Apple Silicon aarch64),
# you must compile your project separately for each architecture, and then
# merge the resulting executables with the 'lipo' utility (a standard macOS tool).
#
# Compilation example (requires an FPC installation with both cross-compilers):
# 1. Compile for Intel: fpc <file.pas> @realms-fpc.cfg -Tdarwin -Px86_64 -o<output_x86_64>
# 2. Compile for Apple Silicon: fpc <file.pas> @realms-fpc.cfg -Tdarwin -Paarch64 -o<output_aarch64>
# 3. Merge: lipo -create <output_x86_64> <output_aarch64> -output realms

# === COMMON SETTINGS ===
# Debugging and optimization
-gw2          # DWARF2 debugging format
-gl           # Line info for debugging
-O2           # Optimization level 2

# Warnings and hints
-vq           # Quiet mode (suppress warnings)
-vwn          # Show notes
-vwe          # Show errors
-vwh          # Show hints
-vww          # Show warnings

# Memory model and stack settings
-CfVFPv3      # Enable ARM NEON/VFPv3 floating-point (primarily for ARM/AArch64)
-OpARM        # Optimize for ARM CPUs (primarily for ARM/AArch64)
-XS           # Strip symbols from the final executable
-Xd           # No default paths

# Linking and output settings
-Xt           # Enable executable smart linking
-FEbuild      # Set output directory
-Forealms     # Set program output name

# Include additional units if needed
-Fu../common
-Fu../server
-Fu../client
-Fu../qcommon
-Fu../game

# =============================================================================
# === MACOS ARCHITECTURES (Intel and Apple Silicon) ===
# =============================================================================

# MACOS X86_64 (Intel)
# This block is activated when targeting Darwin with the x86_64 CPU (-Tdarwin -Px86_64)
#ifdef darwin
#ifdef cpux86_64
-Tdarwin
-Px86_64
-Fu/usr/local/lib/fpc/3.3.1/units/x86_64-darwin/*
-Fl/usr/lib
-Wl,-dead_strip  # Strip unused symbols on macOS
#endif
#endif

# MACOS AARCH64 (Apple Silicon)
# This block is activated when targeting Darwin with the aarch64 CPU (-Tdarwin -Paarch64)
#ifdef darwin
#ifdef cpuaarch64
-Tdarwin
-Paarch64
-Fu/usr/local/lib/fpc/3.3.1/units/aarch64-darwin/*
-Fl/usr/lib
-Wl,-dead_strip  # Strip unused symbols on macOS
#endif
#endif

# === LINUX AARCH64 ===
#ifdef linux
-Tlinux
-Paarch64
-Fu/usr/local/lib/fpc/3.3.1/units/aarch64-linux/*
-Fl/lib/aarch64-linux-gnu
-Fl/usr/lib/aarch64-linux-gnu
-Wl,-dead_strip # Strip unused symbols on Linux (less common, but harmless)
#endif